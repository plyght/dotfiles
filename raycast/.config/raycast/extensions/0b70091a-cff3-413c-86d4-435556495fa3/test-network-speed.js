"use strict";var g=Object.defineProperty;var _=Object.getOwnPropertyDescriptor;var Y=Object.getOwnPropertyNames;var $=Object.prototype.hasOwnProperty;var B=(s,t)=>{for(var i in t)g(s,i,{get:t[i],enumerable:!0})},F=(s,t,i,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Y(t))!$.call(s,a)&&a!==i&&g(s,a,{get:()=>t[a],enumerable:!(o=_(t,a))||o.enumerable});return s};var G=s=>F(g({},"__esModule",{value:!0}),s);var V={};B(V,{default:()=>N});module.exports=G(V);var e=require("@raycast/api");var u=require("@raycast/api"),R=require("react/jsx-runtime");function y(){return(0,R.jsx)(u.ActionPanel.Section,{children:(0,R.jsx)(u.Action,{icon:u.Icon.Gear,title:"Configure Command",shortcut:{modifiers:["shift","cmd"],key:","},onAction:u.openCommandPreferences})})}var r=require("react"),D=require("child_process");function M(s,t){let i,o=t+"E";if(t.includes("Uplink capacity")){let a=o.match(/Uplink capacity: ([\s\S]*?)\nDownlink capacity/),l=o.match(/Idle Latency: ([\s\S]*?)E/),p,d,c,w;s?(p=o.match(/Downlink capacity: ([\s\S]*?)\nUplink Responsiveness/),c=o.match(/Uplink Responsiveness: ([\s\S]*?)\nDownlink/),w=o.match(/Downlink Responsiveness: ([\s\S]*?)\nIdle Latency/),d=null):(p=o.match(/Downlink capacity: ([\s\S]*?)\nResponsiveness/),d=o.match(/Responsiveness: ([\s\S]*?)\nIdle Latency/),c=null,w=null),i={uploadCapacity:a!==null?a[1].trim():"0 Mbps",downloadCapacity:p!==null?p[1].trim():"0 Mbps",uploadResponsiveness:c!==null?c[1].trim():"0 RPM",downloadResponsiveness:w!==null?w[1].trim():"0 RPM",responsiveness:d!==null?d[1].trim():"0 RPM",idleLatency:l!==null?l[1].trim():"0 milli-seconds",hasIdleLatency:!0}}else{let a=o.match(/Upload capacity: ([\s\S]*?)\nDownload capacity/),l=o.match(/Download capacity: ([\s\S]*?)\nUpload flows/),p=o.match(/Responsiveness: ([\s\S]*?)E/),d=o.match(/Upload Responsiveness: ([\s\S]*?)\nDownload/),c=o.match(/Download Responsiveness: ([\s\S]*?)E/);i={uploadCapacity:a!==null?a[1].trim():"0 Mbps",downloadCapacity:l!==null?l[1].trim():"0 Mbps",uploadResponsiveness:d!==null?d[1].trim():"0 RPM",downloadResponsiveness:c!==null?c[1].trim():"0 RPM",responsiveness:p!==null?p[1].trim():"0 RPM",hasIdleLatency:!1}}return i}function b(s){let t=s.replaceAll("responsiveness ","").replaceAll("capacity ",""),i=/Downlink: ([\d.]+ Mbps).*Uplink: ([\d.]+ Mbps)/,o=t.match(i);if(o){let a=o[1]||"",l=o[2]||"";if(a&&l)return`Downlink: ${a}, Uplink: ${l}`}return"Takes about 20 seconds"}var L=require("@raycast/api");var T=(s=!1)=>{let[t,i]=(0,r.useState)(""),[o,a]=(0,r.useState)(""),[l,p]=(0,r.useState)(),[d,c]=(0,r.useState)("Takes about 20 seconds"),[w,U]=(0,r.useState)(!0),h=(0,r.useCallback)(async()=>{let S=new L.Cache,k=S.get("time_cost");k&&parseInt(k)>20&&c(`Takes about ${k} seconds`);let x=s?"-s":"",E=Date.now(),P=(0,D.spawn)("networkQuality",[x],{shell:!0}),A=O=>{let v=String(O),I=(Date.now()-E)/1e3;i(I.toFixed(0)),S.set("time_cost",I.toFixed(0)),v.includes("SUMMARY")?(p(M(s,v)),a(v.slice(v.indexOf("="))),U(!1)):c(b(v))};return P.stdout.on("data",A),()=>{P.stdout.off("data",A)}},[]);return(0,r.useEffect)(()=>{let S;return h().then(k=>{S=k}),()=>{S&&S()}},[h]),{networkSpeedInfo:o,networkSpeed:l,networkSpeedLoading:d,testTime:t,loading:w}};var C=require("@raycast/api");var m=require("react/jsx-runtime");function f(s){let{value:t}=s;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(C.ActionPanel.Section,{children:(0,m.jsx)(C.Action.CopyToClipboard,{title:"Copy Network Speed Info",content:t})}),(0,m.jsx)(y,{})]})}var n=require("react/jsx-runtime");function N(){let{testSequentially:s}=(0,e.getPreferenceValues)(),{networkSpeedInfo:t,networkSpeed:i,networkSpeedLoading:o,testTime:a,loading:l}=T(s);return(0,n.jsxs)(e.List,{searchBarPlaceholder:"Search network speed info",filtering:!1,children:[(0,n.jsx)(e.List.EmptyView,{icon:"loading/loading.gif",title:l?"Testing Your Connection...":"No info",description:l?o:"",actions:(0,n.jsx)(e.ActionPanel,{children:(0,n.jsx)(y,{})})}),!l&&(0,n.jsxs)(e.List.Section,{title:"Time Cost",subtitle:a+"s",children:[(0,n.jsx)(e.List.Item,{title:{value:"Downlink",tooltip:"Downlink Capacity"},icon:{source:e.Icon.Download,tintColor:e.Color.Blue},subtitle:i?.downloadCapacity,actions:(0,n.jsx)(e.ActionPanel,{children:(0,n.jsx)(f,{value:t})})}),(0,n.jsx)(e.List.Item,{title:{value:"Uplink",tooltip:"Uplink Capacity"},icon:{source:e.Icon.Upload,tintColor:e.Color.Red},subtitle:i?.uploadCapacity,actions:(0,n.jsx)(e.ActionPanel,{children:(0,n.jsx)(f,{value:t})})}),!s&&(0,n.jsx)(e.List.Item,{title:{value:"RPM",tooltip:"Responsiveness"},icon:{source:e.Icon.Switch,tintColor:e.Color.Yellow},subtitle:i?.responsiveness,actions:(0,n.jsx)(e.ActionPanel,{children:(0,n.jsx)(f,{value:t})})}),s&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.List.Item,{title:{value:"RPM",tooltip:"Downlink Responsiveness"},icon:{source:e.Icon.ArrowDown,tintColor:e.Color.Green},subtitle:i?.downloadResponsiveness,actions:(0,n.jsx)(e.ActionPanel,{children:(0,n.jsx)(f,{value:t})})}),(0,n.jsx)(e.List.Item,{title:{value:"RPM",tooltip:"Uplink Responsiveness"},icon:{source:e.Icon.ArrowUp,tintColor:e.Color.Orange},subtitle:i?.uploadResponsiveness,actions:(0,n.jsx)(e.ActionPanel,{children:(0,n.jsx)(f,{value:t})})})]}),i?.hasIdleLatency&&(0,n.jsx)(e.List.Item,{title:{value:"Latency",tooltip:"Idle Latency"},icon:{source:e.Icon.Heartbeat,tintColor:e.Color.Purple},subtitle:i?.idleLatency,actions:(0,n.jsx)(e.ActionPanel,{children:(0,n.jsx)(f,{value:t})})})]})]})}
